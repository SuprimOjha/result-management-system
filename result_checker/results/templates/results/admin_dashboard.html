<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Academia — College Result Management</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
/* ─────────────────────── RESET ─────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }

:root {
  --bg:          #f4f5f7;
  --white:       #ffffff;
  --surface:     #fafafa;

  --navy:        #0d1b2a;
  --navy-2:      #1b2d42;

  --blue:        #1a56db;
  --blue-muted:  #e8effe;
  --blue-mid:    #5a8dee;

  --emerald:     #059669;
  --emerald-bg:  #d1fae5;

  --amber:       #d97706;
  --amber-bg:    #fef3c7;

  --rose:        #dc2626;
  --rose-bg:     #fee2e2;

  --slate:       #64748b;
  --border:      #e4e7ec;
  --border-2:    #c9d0db;

  --text:        #0d1b2a;
  --text-mid:    #374151;
  --text-muted:  #64748b;

  --sidebar-w:   258px;
  --topbar-h:    60px;
  --radius:      12px;
  --radius-sm:   8px;
  --shadow-sm:   0 1px 3px rgba(0,0,0,.06), 0 1px 2px rgba(0,0,0,.04);
  --shadow:      0 2px 8px rgba(0,0,0,.07), 0 1px 3px rgba(0,0,0,.05);
  --shadow-lg:   0 8px 24px rgba(0,0,0,.10), 0 2px 8px rgba(0,0,0,.06);
}

body {
  font-family: 'Outfit', sans-serif;
  background: var(--bg);
  color: var(--text);
  display: flex;
  min-height: 100vh;
  font-size: 14px;
  line-height: 1.5;
}

/* ─────────────────────── SCROLLBAR ─────────────────────── */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border-2); border-radius: 99px; }

/* ─────────────────────── SIDEBAR ─────────────────────── */
.sidebar {
  width: var(--sidebar-w);
  background: var(--navy);
  height: 100vh;
  position: fixed;
  top: 0; left: 0;
  display: flex;
  flex-direction: column;
  z-index: 300;
  transition: transform .3s cubic-bezier(.4,0,.2,1);
  overflow-y: auto;
  overflow-x: hidden;
}

.sb-brand {
  padding: 22px 20px 18px;
  display: flex;
  align-items: center;
  gap: 12px;
  border-bottom: 1px solid rgba(255,255,255,.07);
}

.sb-logo {
  width: 38px; height: 38px;
  background: var(--blue);
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  color: #fff;
  font-size: 1rem;
  flex-shrink: 0;
}

.sb-brand-text { line-height: 1.2; }
.sb-title { font-family: 'Instrument Serif', serif; font-size: 1.15rem; color: #fff; letter-spacing: -.2px; }
.sb-sub   { font-size: .62rem; color: rgba(255,255,255,.38); text-transform: uppercase; letter-spacing: 1px; }

.sb-section { font-size: .58rem; font-weight: 600; letter-spacing: 1.8px; text-transform: uppercase; color: rgba(255,255,255,.28); padding: 18px 20px 5px; }

.sb-link {
  display: flex; align-items: center; gap: 10px;
  padding: 9px 20px;
  color: rgba(255,255,255,.52);
  font-size: .84rem; font-weight: 500;
  cursor: pointer;
  transition: all .18s;
  text-decoration: none;
  border-left: 3px solid transparent;
}
.sb-link i { width: 17px; text-align: center; font-size: .82rem; flex-shrink: 0; }
.sb-link .arrow { margin-left: auto; font-size: .62rem; }
.sb-link:hover { color: rgba(255,255,255,.88); background: rgba(255,255,255,.05); }
.sb-link.active {
  color: #fff;
  background: rgba(26,86,219,.22);
  border-left-color: var(--blue-mid);
}

.sb-pill {
  margin-left: auto;
  background: var(--blue);
  color: #fff;
  font-size: .58rem;
  font-weight: 700;
  padding: 2px 8px;
  border-radius: 99px;
}

.sb-footer {
  margin-top: auto;
  padding: 14px 20px 18px;
  border-top: 1px solid rgba(255,255,255,.07);
}

.sb-user {
  display: flex; align-items: center; gap: 10px;
  cursor: pointer;
}

.sb-user-av {
  width: 34px; height: 34px;
  border-radius: 8px;
  background: linear-gradient(135deg, #1a56db, #5a8dee);
  display: flex; align-items: center; justify-content: center;
  color: #fff; font-weight: 700; font-size: .78rem;
  flex-shrink: 0;
}

.sb-user-name { font-size: .8rem; font-weight: 600; color: #fff; }
.sb-user-role { font-size: .63rem; color: rgba(255,255,255,.38); }

/* ─────────────────────── MAIN ─────────────────────── */
.main { margin-left: var(--sidebar-w); flex: 1; display: flex; flex-direction: column; min-height: 100vh; }

/* ─────────────────────── TOPBAR ─────────────────────── */
.topbar {
  height: var(--topbar-h);
  background: var(--white);
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center;
  padding: 0 26px; gap: 14px;
  position: sticky; top: 0; z-index: 100;
  box-shadow: var(--shadow-sm);
}

.hamburger {
  display: none;
  background: none; border: none;
  font-size: 1.05rem; color: var(--text);
  cursor: pointer; padding: 6px;
  border-radius: 7px;
}
.hamburger:hover { background: var(--bg); }

.topbar-title { font-family: 'Instrument Serif', serif; font-size: 1.1rem; color: var(--navy); }
.topbar-crumb { font-size: .7rem; color: var(--text-muted); }

.topbar-right { display: flex; align-items: center; gap: 8px; margin-left: auto; }

.role-badge {
  background: var(--blue-muted);
  color: var(--blue);
  font-size: .68rem;
  font-weight: 600;
  padding: 4px 10px;
  border-radius: 99px;
  display: flex; align-items: center; gap: 5px;
}

.tb-icon-btn {
  width: 34px; height: 34px;
  background: none; border: 1px solid var(--border);
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  color: var(--slate); font-size: .85rem;
  cursor: pointer; transition: all .15s;
  position: relative;
}
.tb-icon-btn:hover { background: var(--bg); border-color: var(--border-2); color: var(--navy); }

.notif-dot {
  position: absolute; top: -3px; right: -3px;
  width: 8px; height: 8px;
  background: var(--rose); border-radius: 50%;
  border: 2px solid var(--white);
}

.topbar-divider { width: 1px; height: 24px; background: var(--border); }

.topbar-user {
  display: flex; align-items: center; gap: 9px;
  cursor: pointer; padding: 4px 8px;
  border-radius: 9px; transition: background .15s;
}
.topbar-user:hover { background: var(--bg); }

.topbar-av {
  width: 32px; height: 32px;
  border-radius: 8px;
  background: linear-gradient(135deg, #1a56db, #5a8dee);
  display: flex; align-items: center; justify-content: center;
  color: #fff; font-weight: 700; font-size: .75rem;
  flex-shrink: 0;
}

.topbar-name { font-size: .8rem; font-weight: 600; }
.topbar-role { font-size: .63rem; color: var(--text-muted); }

/* ─────────────────────── CONTENT ─────────────────────── */
.content { padding: 24px 26px; flex: 1; }

/* ─────────────────────── TAB BAR ─────────────────────── */
.tab-bar {
  display: flex; gap: 2px;
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 4px;
  margin-bottom: 22px;
  box-shadow: var(--shadow-sm);
  overflow-x: auto;
}

.tab {
  flex-shrink: 0;
  height: 36px; padding: 0 18px;
  background: none; border: none;
  border-radius: 9px;
  font-family: 'Outfit', sans-serif;
  font-size: .8rem; font-weight: 500;
  color: var(--text-muted);
  cursor: pointer;
  display: flex; align-items: center; gap: 7px;
  transition: all .18s;
  white-space: nowrap;
}
.tab:hover { color: var(--text); background: var(--bg); }
.tab.active { background: var(--navy); color: #fff; font-weight: 600; }
.tab .tab-count {
  background: rgba(255,255,255,.22);
  font-size: .62rem;
  padding: 1px 6px;
  border-radius: 99px;
  font-weight: 700;
}
.tab:not(.active) .tab-count { background: var(--border); color: var(--slate); }

/* ─────────────────────── PANEL ─────────────────────── */
.panel { display: none; }
.panel.active { display: block; animation: fadeIn .28s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

/* ─────────────────────── STAT ROW ─────────────────────── */
.stat-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 14px;
  margin-bottom: 22px;
}

.stat {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 18px 20px;
  display: flex; align-items: flex-start; justify-content: space-between;
  box-shadow: var(--shadow-sm);
  transition: all .2s;
  position: relative;
  overflow: hidden;
}
.stat::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0;
  width: 100%; height: 3px;
  border-radius: 0 0 var(--radius) var(--radius);
}
.stat:nth-child(1)::after { background: var(--blue); }
.stat:nth-child(2)::after { background: var(--emerald); }
.stat:nth-child(3)::after { background: var(--rose); }
.stat:nth-child(4)::after { background: var(--amber); }
.stat:hover { box-shadow: var(--shadow-lg); transform: translateY(-2px); }

.stat-text {}
.stat-label { font-size: .7rem; font-weight: 500; color: var(--text-muted); text-transform: uppercase; letter-spacing: .6px; margin-bottom: 5px; }
.stat-value { font-family: 'Instrument Serif', serif; font-size: 2rem; line-height: 1; color: var(--navy); }
.stat-sub { font-size: .68rem; color: var(--text-muted); margin-top: 4px; }
.stat-sub .up   { color: var(--emerald); font-weight: 600; }
.stat-sub .down { color: var(--rose); font-weight: 600; }

.stat-icon {
  width: 40px; height: 40px;
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-size: .95rem;
  flex-shrink: 0;
}
.si-blue    { background: var(--blue-muted); color: var(--blue); }
.si-emerald { background: var(--emerald-bg); color: var(--emerald); }
.si-rose    { background: var(--rose-bg); color: var(--rose); }
.si-amber   { background: var(--amber-bg); color: var(--amber); }

/* ─────────────────────── CARD ─────────────────────── */
.card {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-sm);
  margin-bottom: 18px;
  overflow: hidden;
}

.card-hd {
  display: flex; align-items: center; justify-content: space-between;
  padding: 16px 22px;
  border-bottom: 1px solid var(--border);
  gap: 12px; flex-wrap: wrap;
}

.card-hd-l { display: flex; align-items: center; gap: 10px; }

.card-ico {
  width: 32px; height: 32px;
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: .8rem;
}
.ci-blue    { background: var(--blue-muted); color: var(--blue); }
.ci-emerald { background: var(--emerald-bg); color: var(--emerald); }
.ci-amber   { background: var(--amber-bg); color: var(--amber); }
.ci-rose    { background: var(--rose-bg); color: var(--rose); }

.card-title { font-size: .88rem; font-weight: 600; }
.card-sub   { font-size: .68rem; color: var(--text-muted); margin-top: 1px; }

.card-body  { padding: 20px 22px; }

/* ─────────────────────── BUTTONS ─────────────────────── */
.btn {
  display: inline-flex; align-items: center; gap: 7px;
  height: 36px; padding: 0 16px;
  border: none; border-radius: var(--radius-sm);
  font-family: 'Outfit', sans-serif;
  font-size: .8rem; font-weight: 600;
  cursor: pointer; transition: all .17s;
  white-space: nowrap;
}
.btn-sm { height: 31px; padding: 0 12px; font-size: .75rem; }
.btn-lg { height: 42px; padding: 0 22px; font-size: .88rem; }

.btn-primary  { background: var(--navy); color: #fff; }
.btn-primary:hover { background: var(--navy-2); box-shadow: 0 4px 12px rgba(13,27,42,.2); }

.btn-blue     { background: var(--blue); color: #fff; }
.btn-blue:hover { background: #1746c0; box-shadow: 0 4px 12px rgba(26,86,219,.25); }

.btn-emerald  { background: var(--emerald); color: #fff; }
.btn-emerald:hover { background: #047857; }

.btn-outline  { background: var(--white); color: var(--text-mid); border: 1.5px solid var(--border); }
.btn-outline:hover { background: var(--bg); border-color: var(--border-2); }

.btn-ghost    { background: none; color: var(--slate); border: none; }
.btn-ghost:hover { color: var(--navy); background: var(--bg); }

.btn-danger   { background: var(--rose-bg); color: var(--rose); border: none; }
.btn-danger:hover { background: #fecaca; }

/* ─────────────────────── UPLOAD ZONE ─────────────────────── */
.upload-zone {
  border: 2px dashed var(--border-2);
  border-radius: var(--radius);
  padding: 52px 24px;
  text-align: center;
  background: var(--surface);
  cursor: pointer;
  transition: all .2s;
  position: relative;
}
.upload-zone:hover, .upload-zone.over {
  border-color: var(--blue);
  background: var(--blue-muted);
}
.upload-zone input[type="file"] {
  position: absolute; inset: 0;
  opacity: 0; cursor: pointer;
  width: 100%; height: 100%;
}

.upload-icon-wrap {
  width: 64px; height: 64px;
  background: var(--white);
  border: 2px solid var(--border);
  border-radius: 16px;
  display: flex; align-items: center; justify-content: center;
  margin: 0 auto 16px;
  font-size: 1.5rem;
  color: var(--blue);
  box-shadow: var(--shadow-sm);
  transition: all .2s;
}
.upload-zone:hover .upload-icon-wrap { border-color: var(--blue); box-shadow: 0 0 0 4px rgba(26,86,219,.1); }

.upload-heading { font-size: .95rem; font-weight: 600; margin-bottom: 6px; }
.upload-hint    { font-size: .78rem; color: var(--text-muted); margin-bottom: 18px; }

.format-pills { display: flex; gap: 8px; justify-content: center; flex-wrap: wrap; }
.format-pill {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 99px;
  padding: 4px 12px;
  font-size: .7rem;
  font-weight: 600;
  color: var(--slate);
  display: flex; align-items: center; gap: 5px;
}
.format-pill i { color: var(--emerald); }

/* ─────────────────────── PROGRESS ─────────────────────── */
.prog-wrap { display: none; margin-top: 22px; }
.prog-wrap.show { display: block; }
.prog-meta { display: flex; justify-content: space-between; font-size: .74rem; font-weight: 500; margin-bottom: 6px; }
.prog-track { background: var(--border); border-radius: 99px; height: 7px; overflow: hidden; }
.prog-fill  { height: 100%; border-radius: 99px; background: linear-gradient(90deg, var(--blue), #5a8dee); width: 0%; transition: width .35s ease; }

/* ─────────────────────── TABLE ─────────────────────── */
.tbl-wrap { overflow-x: auto; }

table.data-tbl { width: 100%; border-collapse: collapse; min-width: 600px; }

.data-tbl thead tr {
  background: var(--navy);
}
.data-tbl thead th {
  padding: 11px 16px;
  font-size: .7rem;
  font-weight: 600;
  letter-spacing: .5px;
  text-transform: uppercase;
  color: rgba(255,255,255,.75);
  text-align: left;
  white-space: nowrap;
}
.data-tbl thead th:first-child { border-radius: 0; }

.data-tbl tbody tr {
  border-bottom: 1px solid var(--border);
  transition: background .1s;
}
.data-tbl tbody tr:hover { background: #f8f9ff; }
.data-tbl tbody tr:last-child { border-bottom: none; }

.data-tbl tbody td {
  padding: 11px 16px;
  font-size: .82rem;
  vertical-align: middle;
}

/* ─────────────────────── BADGES / CHIPS ─────────────────────── */
.grade-chip {
  display: inline-flex; align-items: center; justify-content: center;
  width: 27px; height: 27px;
  border-radius: 7px;
  font-size: .74rem; font-weight: 700;
}
.g-A { background: var(--emerald-bg); color: var(--emerald); }
.g-B { background: #d1fae5; color: #065f46; }
.g-C { background: var(--amber-bg); color: var(--amber); }
.g-D { background: #fed7aa; color: #c2410c; }
.g-F { background: var(--rose-bg); color: var(--rose); }

.status-pill {
  padding: 3px 10px;
  border-radius: 99px;
  font-size: .68rem; font-weight: 600;
  white-space: nowrap;
}
.sp-pass { background: var(--emerald-bg); color: var(--emerald); }
.sp-fail { background: var(--rose-bg); color: var(--rose); }

/* ─────────────────────── ACTION BTNS ─────────────────────── */
.act {
  background: none; border: none;
  padding: 5px 7px; border-radius: 7px;
  cursor: pointer; font-size: .8rem;
  color: var(--slate); transition: all .14s;
}
.act:hover        { background: var(--bg); color: var(--navy); }
.act.del:hover    { background: var(--rose-bg); color: var(--rose); }
.act.edit:hover   { background: var(--blue-muted); color: var(--blue); }
.act.view:hover   { background: var(--emerald-bg); color: var(--emerald); }

/* ─────────────────────── FILTER BAR ─────────────────────── */
.filter-bar { display: flex; gap: 9px; flex-wrap: wrap; align-items: center; margin-bottom: 16px; }

.search-wrap { position: relative; flex: 1; min-width: 200px; }
.search-wrap i { position: absolute; left: 11px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: .82rem; pointer-events: none; }
.search-field {
  width: 100%; height: 36px;
  border: 1.5px solid var(--border); border-radius: var(--radius-sm);
  padding: 0 12px 0 33px;
  font-family: 'Outfit', sans-serif; font-size: .82rem;
  color: var(--text); background: var(--white); outline: none;
  transition: all .15s;
}
.search-field:focus { border-color: var(--blue); box-shadow: 0 0 0 3px rgba(26,86,219,.08); }

.filter-sel {
  height: 36px; padding: 0 11px;
  border: 1.5px solid var(--border); border-radius: var(--radius-sm);
  font-family: 'Outfit', sans-serif; font-size: .8rem;
  color: var(--text); background: var(--white); outline: none;
  cursor: pointer; transition: all .15s; min-width: 130px;
}
.filter-sel:focus { border-color: var(--blue); }

/* ─────────────────────── FORM ─────────────────────── */
.form-row { display: grid; gap: 14px; margin-bottom: 16px; }
.form-row-3 { grid-template-columns: repeat(3, 1fr); }
.form-row-2 { grid-template-columns: repeat(2, 1fr); }

.form-group { display: flex; flex-direction: column; gap: 5px; }
.form-label {
  font-size: .74rem; font-weight: 600;
  color: var(--text-mid);
  display: flex; align-items: center; gap: 4px;
}
.req { color: var(--rose); }

.form-ctrl, .form-sel {
  height: 38px;
  border: 1.5px solid var(--border); border-radius: var(--radius-sm);
  padding: 0 12px;
  font-family: 'Outfit', sans-serif; font-size: .83rem;
  color: var(--text); background: var(--white); outline: none;
  transition: all .15s;
}
.form-ctrl:focus, .form-sel:focus {
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(26,86,219,.08);
}
.form-ctrl::placeholder { color: #b0b8c4; }

/* ─────────────────────── SUBJECT BLOCK ─────────────────────── */
.subj-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 16px; }

.subj-card {
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 14px;
  transition: border-color .15s;
}
.subj-card:focus-within { border-color: var(--blue); }

.subj-label { font-size: .68rem; font-weight: 700; color: var(--blue); text-transform: uppercase; letter-spacing: .5px; margin-bottom: 9px; display: flex; align-items: center; justify-content: space-between; }

.mini-lbl { font-size: .65rem; color: var(--text-muted); margin-bottom: 3px; }
.mini-ctrl {
  width: 100%; height: 32px;
  border: 1.5px solid var(--border); border-radius: 6px;
  padding: 0 9px; margin-bottom: 8px;
  font-family: 'Outfit', sans-serif; font-size: .79rem;
  color: var(--text); background: var(--white); outline: none;
  transition: all .15s;
}
.mini-ctrl:focus { border-color: var(--blue); }
.mini-ctrl:last-of-type { margin-bottom: 0; }

/* ─────────────────────── SUMMARY ROW ─────────────────────── */
.summary-row {
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;
  background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius-sm);
  padding: 14px; margin-top: 16px;
}
.summary-cell .lbl { font-size: .65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: .5px; margin-bottom: 4px; }
.summary-cell .val { font-family: 'Instrument Serif', serif; font-size: 1.2rem; color: var(--navy); }

/* ─────────────────────── PAGINATION ─────────────────────── */
.pagination {
  display: flex; align-items: center; justify-content: space-between;
  padding: 13px 22px; border-top: 1px solid var(--border);
  flex-wrap: wrap; gap: 8px;
}
.pg-info { font-size: .74rem; color: var(--text-muted); }
.pg-btns { display: flex; gap: 4px; }
.pg-btn {
  width: 30px; height: 30px;
  border: 1px solid var(--border); border-radius: 7px;
  background: var(--white); color: var(--text-mid);
  font-family: 'Outfit', sans-serif; font-size: .76rem;
  cursor: pointer; display: flex; align-items: center; justify-content: center;
  transition: all .15s;
}
.pg-btn:hover { background: var(--bg); border-color: var(--border-2); }
.pg-btn.active { background: var(--navy); color: #fff; border-color: var(--navy); }
.pg-btn:disabled { opacity: .35; cursor: not-allowed; }

/* ─────────────────────── EMPTY STATE ─────────────────────── */
.empty {
  text-align: center; padding: 52px 24px; color: var(--text-muted);
}
.empty-icon {
  width: 56px; height: 56px;
  background: var(--bg); border-radius: 14px;
  border: 1px solid var(--border);
  display: flex; align-items: center; justify-content: center;
  margin: 0 auto 14px; font-size: 1.3rem; color: var(--border-2);
}
.empty h3 { font-size: .88rem; font-weight: 600; color: var(--text-mid); margin-bottom: 4px; }
.empty p  { font-size: .78rem; max-width: 280px; margin: 0 auto; }

/* ─────────────────────── MARKSHEET ─────────────────────── */
.ms-wrap {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
}

.ms-hd {
  background: var(--navy);
  padding: 28px 32px;
  text-align: center;
  color: #fff;
}

.ms-college-name { font-family: 'Instrument Serif', serif; font-size: 1.5rem; letter-spacing: -.3px; }
.ms-college-sub  { font-size: .72rem; opacity: .5; margin-top: 3px; }
.ms-type-badge {
  display: inline-block;
  margin-top: 12px;
  background: rgba(255,255,255,.1);
  border: 1px solid rgba(255,255,255,.18);
  padding: 4px 18px;
  border-radius: 99px;
  font-size: .72rem;
  font-weight: 600;
  letter-spacing: .8px;
  text-transform: uppercase;
}

.ms-info-grid {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 0;
  border-bottom: 1px solid var(--border);
}
.ms-info-cell {
  padding: 14px 22px;
  border-right: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
}
.ms-info-cell:nth-child(3n) { border-right: none; }
.ms-info-cell:nth-last-child(-n+3):nth-child(3n+1) ~ .ms-info-cell,
.ms-info-cell:last-child { border-right: none; }
.ms-info-lbl { font-size: .62rem; font-weight: 600; text-transform: uppercase; letter-spacing: .8px; color: var(--text-muted); margin-bottom: 3px; }
.ms-info-val { font-size: .85rem; font-weight: 600; color: var(--navy); }

.ms-body { padding: 22px 28px; }

.ms-tbl { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
.ms-tbl thead tr { background: var(--bg); }
.ms-tbl thead th { padding: 10px 14px; font-size: .7rem; font-weight: 700; text-transform: uppercase; letter-spacing: .5px; color: var(--text-muted); text-align: left; border-bottom: 2px solid var(--border); }
.ms-tbl tbody td { padding: 10px 14px; font-size: .82rem; border-bottom: 1px solid var(--border); }
.ms-tbl tbody tr:last-child td { border-bottom: none; }

.ms-totals {
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;
  background: var(--navy); border-radius: var(--radius-sm);
  padding: 16px 20px; color: #fff;
}
.ms-tot-lbl { font-size: .62rem; opacity: .55; text-transform: uppercase; letter-spacing: .6px; margin-bottom: 4px; }
.ms-tot-val { font-family: 'Instrument Serif', serif; font-size: 1.3rem; }

.ms-footer {
  padding: 14px 22px;
  border-top: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
  font-size: .72rem; color: var(--text-muted);
  flex-wrap: wrap; gap: 8px;
}

/* ─────────────────────── MODAL ─────────────────────── */
.modal-bg {
  display: none; position: fixed; inset: 0;
  background: rgba(13,27,42,.45);
  z-index: 600;
  align-items: center; justify-content: center;
  padding: 16px;
}
.modal-bg.open { display: flex; }

.modal {
  background: var(--white); border-radius: var(--radius);
  width: 100%; max-width: 540px; max-height: 90vh; overflow-y: auto;
  animation: modalPop .22s ease;
  box-shadow: var(--shadow-lg);
}
@keyframes modalPop { from { opacity: 0; transform: scale(.93) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }

.modal-head { display: flex; align-items: center; justify-content: space-between; padding: 17px 22px; border-bottom: 1px solid var(--border); }
.modal-title { font-size: .9rem; font-weight: 600; }
.modal-close { width: 28px; height: 28px; background: var(--bg); border: none; border-radius: 7px; cursor: pointer; color: var(--slate); display: flex; align-items: center; justify-content: center; transition: all .14s; }
.modal-close:hover { background: var(--rose-bg); color: var(--rose); }
.modal-body { padding: 22px; }
.modal-foot { padding: 14px 22px; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 8px; }

/* ─────────────────────── TOAST ─────────────────────── */
.toast-stack { position: fixed; bottom: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 8px; }
.toast {
  display: flex; align-items: center; gap: 10px;
  background: var(--navy); color: #fff;
  padding: 12px 16px; border-radius: var(--radius-sm);
  font-size: .81rem; min-width: 240px;
  box-shadow: var(--shadow-lg);
  animation: toastIn .25s ease;
  border-left: 4px solid transparent;
}
.toast.ok     { border-left-color: var(--emerald); }
.toast.ok i   { color: #4ade80; }
.toast.err    { border-left-color: var(--rose); }
.toast.err i  { color: #f87171; }
.toast.info   { border-left-color: var(--blue-mid); }
.toast.info i { color: #93c5fd; }
@keyframes toastIn { from { opacity: 0; transform: translateX(24px); } to { opacity: 1; transform: translateX(0); } }

/* ─────────────────────── DASHBOARD EXTRAS ─────────────────────── */
.dash-grid { display: grid; grid-template-columns: 1.6fr 1fr; gap: 16px; margin-bottom: 18px; }

.grade-bar-row {
  display: flex; align-items: center; gap: 10px; margin-bottom: 9px;
}
.grade-bar-lbl { font-size: .72rem; font-weight: 700; min-width: 14px; }
.grade-bar-track { flex: 1; background: var(--bg); border-radius: 99px; height: 9px; overflow: hidden; border: 1px solid var(--border); }
.grade-bar-fill  { height: 100%; border-radius: 99px; transition: width 1s ease; }
.grade-bar-cnt { font-size: .7rem; color: var(--text-muted); min-width: 55px; text-align: right; }

.top-student-row {
  display: flex; align-items: center; gap: 11px;
  padding: 9px 0; border-bottom: 1px solid var(--border);
}
.top-student-row:last-child { border-bottom: none; }
.rank-badge {
  width: 24px; height: 24px; border-radius: 7px;
  display: flex; align-items: center; justify-content: center;
  font-size: .68rem; font-weight: 700; flex-shrink: 0;
}
.rank-1 { background: #fef3c7; color: #92400e; }
.rank-2 { background: #f1f5f9; color: #475569; }
.rank-3 { background: #fef2f2; color: #7f1d1d; }
.rank-n { background: var(--bg); color: var(--text-muted); }
.top-sname { font-size: .8rem; font-weight: 600; }
.top-smeta { font-size: .65rem; color: var(--text-muted); }
.top-spct  { margin-left: auto; font-size: .82rem; font-weight: 700; color: var(--blue); }

/* ─────────────────────── SEARCH RESULT CHIPS ─────────────────────── */
.ms-search-chip {
  background: var(--white);
  border: 1.5px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 10px 14px;
  cursor: pointer;
  font-family: inherit;
  text-align: left;
  min-width: 200px;
  transition: all .16s;
}
.ms-search-chip:hover { border-color: var(--blue); box-shadow: 0 0 0 3px rgba(26,86,219,.08); }
.ms-search-chip-name { font-size: .82rem; font-weight: 600; color: var(--navy); }
.ms-search-chip-meta { font-size: .68rem; color: var(--text-muted); margin-top: 2px; }

/* ─────────────────────── OVERLAY ─────────────────────── */
.sb-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,.38); z-index: 200; }

/* ─────────────────────── RESPONSIVE ─────────────────────── */
@media (max-width: 1100px) {
  .stat-row { grid-template-columns: repeat(2, 1fr); }
  .dash-grid { grid-template-columns: 1fr; }
}
@media (max-width: 900px) {
  .form-row-3 { grid-template-columns: repeat(2, 1fr); }
  .subj-grid  { grid-template-columns: repeat(2, 1fr); }
  .ms-info-grid { grid-template-columns: repeat(2, 1fr); }
  .ms-totals { grid-template-columns: repeat(2, 1fr); }
  .summary-row { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 768px) {
  .sidebar { transform: translateX(-100%); }
  .sidebar.open { transform: translateX(0); box-shadow: 8px 0 30px rgba(0,0,0,.18); }
  .sb-overlay.active { display: block; }
  .hamburger { display: flex; }
  .main { margin-left: 0; }
  .content { padding: 16px; }
  .topbar { padding: 0 16px; }
  .role-badge, .topbar-name, .topbar-role { display: none; }
  .stat-row { grid-template-columns: 1fr 1fr; }
  .form-row-3 { grid-template-columns: 1fr; }
  .form-row-2 { grid-template-columns: 1fr; }
  .ms-totals { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 500px) {
  .stat-row { grid-template-columns: 1fr; }
  .subj-grid { grid-template-columns: 1fr; }
  .ms-info-grid { grid-template-columns: 1fr; }
  .ms-info-cell { border-right: none; border-bottom: 1px solid var(--border); }
}

/* ─────────────────────── PRINT ─────────────────────── */
@media print {
  .sidebar, .topbar, .tab-bar, .no-print { display: none !important; }
  .main { margin-left: 0; }
  .content { padding: 0; }
  .panel { display: block !important; }
  .ms-wrap { box-shadow: none; border: none; }
}
</style>
</head>
<body>

<!-- Toast Stack -->
<div class="toast-stack" id="toastStack"></div>

<!-- Sidebar Overlay -->
<div class="sb-overlay" id="sbOverlay" onclick="closeSb()"></div>

<!-- Edit Modal -->
<div class="modal-bg" id="editModal">
  <div class="modal">
    <div class="modal-head">
      <span class="modal-title"><i class="fas fa-pen" style="color:var(--blue);margin-right:8px"></i>Edit Result</span>
      <button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-body">
      <div class="form-row form-row-2" style="margin-bottom:12px">
        <div class="form-group"><label class="form-label">Student Name</label><input class="form-ctrl" id="e-name"></div>
        <div class="form-group"><label class="form-label">Roll Number</label><input class="form-ctrl" id="e-roll"></div>
        <div class="form-group"><label class="form-label"><i class="fas fa-hashtag" style="color:var(--blue)"></i> Symbol Number</label><input class="form-ctrl" id="e-symbol" placeholder="e.g. 11234567"></div>
        <div class="form-group"><label class="form-label">Department</label><input class="form-ctrl" id="e-dept"></div>
        <div class="form-group"><label class="form-label">Semester</label>
          <select class="form-sel" id="e-sem">
            <option>1st Sem</option><option>2nd Sem</option><option>3rd Sem</option>
            <option>4th Sem</option><option>5th Sem</option><option>6th Sem</option>
            <option>7th Sem</option><option>8th Sem</option>
          </select>
        </div>
        <div class="form-group"><label class="form-label">Total Marks</label><input class="form-ctrl" id="e-total" type="number"></div>
        <div class="form-group"><label class="form-label">Obtained Marks</label><input class="form-ctrl" id="e-obtained" type="number"></div>
      </div>
    </div>
    <div class="modal-foot">
      <button class="btn btn-outline" onclick="closeModal()">Cancel</button>
      <button class="btn btn-primary" onclick="saveEdit()"><i class="fas fa-save"></i> Save Changes</button>
    </div>
  </div>
</div>

<!-- ═════════════════ SIDEBAR ═════════════════ -->
<aside class="sidebar" id="sidebar">
  <div class="sb-brand">
    <div class="sb-logo"><i class="fas fa-graduation-cap"></i></div>
    <div class="sb-brand-text">
      <div class="sb-title">Schooli</div>
      <div class="sb-sub">Results Portal</div>
    </div>
  </div>

  <div class="sb-section">Results</div>
  <a class="sb-link active" onclick="setNav(this)"><i class="fas fa-th-large"></i> Dashboard</a>
  <a class="sb-link" onclick="setNav(this)"><i class="fas fa-cloud-upload-alt"></i> Upload Results <span class="sb-pill">Excel</span></a>
  <a class="sb-link" onclick="setNav(this)"><i class="fas fa-keyboard"></i> Manual Entry</a>
  <a class="sb-link" onclick="setNav(this)"><i class="fas fa-table"></i> View All Results</a>
  <a class="sb-link" onclick="setNav(this)"><i class="fas fa-file-invoice"></i> Marksheets</a>

  <div class="sb-section">Management</div>
  <a class="sb-link" onclick="setNav(this)"><i class="fas fa-users-cog"></i> Manage Teachers</a>
  <a class="sb-link" onclick="setNav(this)"><i class="fas fa-sitemap"></i> Departments</a>
  <a class="sb-link" onclick="setNav(this)"><i class="fas fa-book-open"></i> Subjects</a>

  <div class="sb-section">Export</div>
  <a class="sb-link" onclick="exportExcel()"><i class="fas fa-file-excel"></i> Export Excel</a>
  <a class="sb-link" onclick="exportCSV()"><i class="fas fa-file-csv"></i> Export CSV</a>
  <a class="sb-link" onclick="printAllResults()"><i class="fas fa-print"></i> Print All Results</a>
  <a class="sb-link" onclick="setNav(this)"><i class="fas fa-cog"></i> Settings</a>

  <div class="sb-footer">
    <div class="sb-user">
      <div class="sb-user-av">AD</div>
      <div>
        <div class="sb-user-name">Admin User</div>
        <div class="sb-user-role">Administrator</div>
      </div>
    </div>
  </div>
</aside>

<!-- ═════════════════ MAIN ═════════════════ -->
<div class="main">

  <!-- Topbar -->
  <header class="topbar">
    <button class="hamburger" onclick="toggleSb()"><i class="fas fa-bars"></i></button>
    <div>
      <div class="topbar-title">Result Management System</div>
      <div class="topbar-crumb" id="tbCrumb">Dashboard</div>
    </div>
    <div class="topbar-right">
      <div class="role-badge"><i class="fas fa-shield-alt"></i> Admin</div>
      <div class="topbar-divider"></div>
      <div class="tb-icon-btn" title="Notifications">
        <i class="fas fa-bell"></i>
        <span class="notif-dot"></span>
      </div>
      <div class="tb-icon-btn" title="Help"><i class="fas fa-question-circle"></i></div>
      <div class="topbar-divider"></div>
      <div class="topbar-user">
        <div class="topbar-av">AD</div>
        <div>
          <div class="topbar-name">Admin User</div>
          <div class="topbar-role">Administrator</div>
        </div>
        <i class="fas fa-chevron-down" style="font-size:.6rem;color:var(--text-muted);margin-left:6px"></i>
      </div>
    </div>
  </header>

  <!-- Content -->
  <div class="content">

    <!-- ── TABS ── -->
    <div class="tab-bar no-print">
      <button class="tab active" id="tab-dash"     onclick="switchTab('dash')"><i class="fas fa-th-large"></i> Dashboard</button>
      <button class="tab"        id="tab-upload"   onclick="switchTab('upload')"><i class="fas fa-cloud-upload-alt"></i> Upload Excel</button>
      <button class="tab"        id="tab-manual"   onclick="switchTab('manual')"><i class="fas fa-keyboard"></i> Manual Entry</button>
      <button class="tab"        id="tab-view"     onclick="switchTab('view')"><i class="fas fa-table"></i> View Results <span class="tab-count" id="tc-view">0</span></button>
      <button class="tab"        id="tab-marksheet" onclick="switchTab('marksheet')"><i class="fas fa-file-invoice"></i> Marksheets</button>
    </div>

    <!-- ══════════════ DASHBOARD ══════════════ -->
    <div class="panel active" id="panel-dash">

      <div class="stat-row">
        <div class="stat">
          <div class="stat-text">
            <div class="stat-label">Total Records</div>
            <div class="stat-value" id="s-total">0</div>
            <div class="stat-sub">Students entered</div>
          </div>
          <div class="stat-icon si-blue"><i class="fas fa-users"></i></div>
        </div>
        <div class="stat">
          <div class="stat-text">
            <div class="stat-label">Passed</div>
            <div class="stat-value" id="s-pass">0</div>
            <div class="stat-sub"><span class="up" id="s-pass-rate">0%</span> pass rate</div>
          </div>
          <div class="stat-icon si-emerald"><i class="fas fa-check-circle"></i></div>
        </div>
        <div class="stat">
          <div class="stat-text">
            <div class="stat-label">Failed</div>
            <div class="stat-value" id="s-fail">0</div>
            <div class="stat-sub"><span class="down" id="s-fail-rate">0%</span> fail rate</div>
          </div>
          <div class="stat-icon si-rose"><i class="fas fa-times-circle"></i></div>
        </div>
        <div class="stat">
          <div class="stat-text">
            <div class="stat-label">Class Average</div>
            <div class="stat-value" id="s-avg">—</div>
            <div class="stat-sub">Average percentage</div>
          </div>
          <div class="stat-icon si-amber"><i class="fas fa-chart-line"></i></div>
        </div>
      </div>

      <div class="dash-grid">
        <!-- Grade Distribution -->
        <div class="card">
          <div class="card-hd">
            <div class="card-hd-l">
              <div class="card-ico ci-blue"><i class="fas fa-chart-bar"></i></div>
              <div>
                <div class="card-title">Grade Distribution</div>
                <div class="card-sub">All results · current batch</div>
              </div>
            </div>
          </div>
          <div class="card-body" id="gradeDistBody">
            <div class="empty"><div class="empty-icon"><i class="fas fa-chart-bar"></i></div><h3>No data yet</h3><p>Upload or enter results to see grade distribution.</p></div>
          </div>
        </div>

        <!-- Top Performers -->
        <div class="card">
          <div class="card-hd">
            <div class="card-hd-l">
              <div class="card-ico ci-amber"><i class="fas fa-trophy"></i></div>
              <div>
                <div class="card-title">Top Performers</div>
                <div class="card-sub">Ranked by percentage</div>
              </div>
            </div>
          </div>
          <div class="card-body" id="topPerformBody">
            <div class="empty"><div class="empty-icon"><i class="fas fa-trophy"></i></div><h3>No results yet</h3><p>Add results to see top performers.</p></div>
          </div>
        </div>
      </div>

      <!-- Recent Results -->
      <div class="card">
        <div class="card-hd">
          <div class="card-hd-l">
            <div class="card-ico ci-emerald"><i class="fas fa-clock-rotate-left"></i></div>
            <div>
              <div class="card-title">Recently Added</div>
              <div class="card-sub">Last 6 entries</div>
            </div>
          </div>
          <button class="btn btn-outline btn-sm no-print" onclick="switchTab('view')"><i class="fas fa-arrow-right"></i> View All</button>
        </div>
        <div class="tbl-wrap">
          <table class="data-tbl">
            <thead><tr><th>#</th><th>Student Name</th><th>Roll No.</th><th>Semester</th><th>Obtained / Total</th><th>Percentage</th><th>Grade</th><th>Status</th></tr></thead>
            <tbody id="recentTbody">
              <tr><td colspan="8"><div class="empty"><div class="empty-icon"><i class="fas fa-inbox"></i></div><h3>No entries yet</h3></div></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ══════════════ UPLOAD ══════════════ -->
    <div class="panel" id="panel-upload">

      <div class="card">
        <div class="card-hd">
          <div class="card-hd-l">
            <div class="card-ico ci-blue"><i class="fas fa-cloud-upload-alt"></i></div>
            <div>
              <div class="card-title">Upload Excel / CSV Result Sheet</div>
              <div class="card-sub">Drag & drop or browse your file</div>
            </div>
          </div>
          <button class="btn btn-outline btn-sm" onclick="dlTemplate()"><i class="fas fa-download"></i> Download Template</button>
        </div>
        <div class="card-body">
          <div class="upload-zone" id="uploadZone">
            <input type="file" id="fileIn" accept=".xlsx,.xls,.csv" onchange="handleFile(event)">
            <div class="upload-icon-wrap"><i class="fas fa-file-spreadsheet" style="font-size:1.4rem"></i></div>
            <div class="upload-heading">Drop your spreadsheet here</div>
            <div class="upload-hint">or click to browse · .xlsx, .xls, .csv supported · max 10 MB</div>
            <div class="format-pills">
              <span class="format-pill"><i class="fas fa-check-circle"></i> XLSX</span>
              <span class="format-pill"><i class="fas fa-check-circle"></i> XLS</span>
              <span class="format-pill"><i class="fas fa-check-circle"></i> CSV</span>
            </div>
          </div>
          <div class="prog-wrap" id="progWrap">
            <div class="prog-meta"><span id="progLbl">Reading file…</span><span id="progPct">0%</span></div>
            <div class="prog-track"><div class="prog-fill" id="progFill"></div></div>
          </div>
        </div>
      </div>

      <!-- Column Guide -->
      <div class="card">
        <div class="card-hd">
          <div class="card-hd-l">
            <div class="card-ico ci-amber"><i class="fas fa-info-circle"></i></div>
            <div><div class="card-title">Required Column Format</div><div class="card-sub">Your spreadsheet must contain these headers (case-insensitive)</div></div>
          </div>
        </div>
        <div class="tbl-wrap">
          <table class="data-tbl">
            <thead><tr><th>Column Name</th><th>What It Means</th><th>Example Value</th><th>Required?</th></tr></thead>
            <tbody>
              <tr><td><code style="background:var(--bg);padding:2px 6px;border-radius:4px;font-size:.78rem">name</code></td><td>Full name of student</td><td>Priya Sharma</td><td><span class="status-pill sp-pass">Yes</span></td></tr>
              <tr><td><code style="background:var(--bg);padding:2px 6px;border-radius:4px;font-size:.78rem">roll</code></td><td>Roll / Enrolment number</td><td>2022CS001</td><td><span class="status-pill sp-pass">Yes</span></td></tr>
              <tr><td><code style="background:var(--bg);padding:2px 6px;border-radius:4px;font-size:.78rem">symbol</code></td><td>Symbol / Registration number</td><td>11201001</td><td><span class="status-pill sp-pass">Yes</span></td></tr>
              <tr><td><code style="background:var(--bg);padding:2px 6px;border-radius:4px;font-size:.78rem">department</code></td><td>Department or stream</td><td>Computer Science</td><td><span class="status-pill" style="background:var(--bg);color:var(--slate)">Optional</span></td></tr>
              <tr><td><code style="background:var(--bg);padding:2px 6px;border-radius:4px;font-size:.78rem">semester</code></td><td>Semester label</td><td>3rd Sem</td><td><span class="status-pill sp-pass">Yes</span></td></tr>
              <tr><td><code style="background:var(--bg);padding:2px 6px;border-radius:4px;font-size:.78rem">total</code></td><td>Maximum possible marks</td><td>600</td><td><span class="status-pill sp-pass">Yes</span></td></tr>
              <tr><td><code style="background:var(--bg);padding:2px 6px;border-radius:4px;font-size:.78rem">obtained</code></td><td>Marks scored by student</td><td>487</td><td><span class="status-pill sp-pass">Yes</span></td></tr>
              <tr><td><code style="background:var(--bg);padding:2px 6px;border-radius:4px;font-size:.78rem">status</code></td><td>Pass or Fail (auto-calculated if blank)</td><td>Pass</td><td><span class="status-pill" style="background:var(--bg);color:var(--slate)">Optional</span></td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Preview (hidden until upload) -->
      <div class="card" id="previewCard" style="display:none">
        <div class="card-hd">
          <div class="card-hd-l">
            <div class="card-ico ci-emerald"><i class="fas fa-eye"></i></div>
            <div><div class="card-title">Preview</div><div class="card-sub" id="prevSubtitle">0 records ready to import</div></div>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn btn-outline btn-sm" onclick="clearUpload()"><i class="fas fa-trash"></i> Discard</button>
            <button class="btn btn-primary btn-sm" onclick="confirmImport()"><i class="fas fa-check"></i> Import All</button>
          </div>
        </div>
        <div class="tbl-wrap">
          <table class="data-tbl">
            <thead><tr><th>#</th><th>Name</th><th>Roll No.</th><th>Department</th><th>Semester</th><th>Total</th><th>Obtained</th><th>%</th><th>Grade</th><th>Status</th></tr></thead>
            <tbody id="prevTbody"></tbody>
          </table>
        </div>
        <div class="pagination">
          <div class="pg-info" id="prevPgInfo"></div>
          <div class="pg-btns" id="prevPgBtns"></div>
        </div>
      </div>
    </div>

    <!-- ══════════════ MANUAL ENTRY ══════════════ -->
    <div class="panel" id="panel-manual">
      <div class="card">
        <div class="card-hd">
          <div class="card-hd-l">
            <div class="card-ico ci-blue"><i class="fas fa-keyboard"></i></div>
            <div><div class="card-title">Enter Result Manually</div><div class="card-sub">Fill in the student details and subject-wise marks</div></div>
          </div>
        </div>
        <div class="card-body">

          <!-- Section label -->
          <div style="font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.8px;color:var(--text-muted);margin-bottom:12px;display:flex;align-items:center;gap:7px"><i class="fas fa-user" style="color:var(--blue)"></i> Student Information</div>

          <div class="form-row form-row-3">
            <div class="form-group">
              <label class="form-label"><i class="fas fa-user" style="color:var(--blue)"></i> Full Name <span class="req">*</span></label>
              <input class="form-ctrl" id="m-name" placeholder="e.g. Priya Sharma">
            </div>
            <div class="form-group">
              <label class="form-label"><i class="fas fa-id-badge" style="color:var(--blue)"></i> Roll Number <span class="req">*</span></label>
              <input class="form-ctrl" id="m-roll" placeholder="e.g. 2022CS001">
            </div>
            <div class="form-group">
              <label class="form-label"><i class="fas fa-hashtag" style="color:var(--blue)"></i> Symbol Number <span class="req">*</span></label>
              <input class="form-ctrl" id="m-symbol" placeholder="e.g. 11234567">
            </div>
            <div class="form-group">
              <label class="form-label"><i class="fas fa-building" style="color:var(--blue)"></i> Department</label>
              <select class="form-sel" id="m-dept">
                <option value="">-- Select --</option>
                <option>Computer Science</option><option>Electronics</option>
                <option>Mechanical</option><option>Civil</option>
                <option>Business Administration</option><option>Commerce</option>
                <option>Arts & Humanities</option><option>Science</option>
                <option>Law</option><option>Medicine</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label"><i class="fas fa-layer-group" style="color:var(--blue)"></i> Semester <span class="req">*</span></label>
              <select class="form-sel" id="m-sem">
                <option value="">-- Select --</option>
                <option>1st Sem</option><option>2nd Sem</option><option>3rd Sem</option>
                <option>4th Sem</option><option>5th Sem</option><option>6th Sem</option>
                <option>7th Sem</option><option>8th Sem</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label"><i class="fas fa-calendar-alt" style="color:var(--blue)"></i> Academic Year</label>
              <input class="form-ctrl" id="m-year" placeholder="e.g. 2023–24">
            </div>
            <div class="form-group">
              <label class="form-label"><i class="fas fa-file-alt" style="color:var(--blue)"></i> Exam Type</label>
              <select class="form-sel" id="m-examtype">
                <option>Final Examination</option>
                <option>Mid-Term</option>
                <option>Supplementary</option>
                <option>Back Paper</option>
              </select>
            </div>
          </div>

          <div style="height:1px;background:var(--border);margin:18px 0"></div>

          <div style="font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.8px;color:var(--text-muted);margin-bottom:12px;display:flex;align-items:center;justify-content:space-between">
            <span><i class="fas fa-book" style="color:var(--blue)"></i>&nbsp; Subject-wise Marks</span>
            <button class="btn btn-outline btn-sm" onclick="addSubj()"><i class="fas fa-plus"></i> Add Subject</button>
          </div>

          <div class="subj-grid" id="subjGrid">
            <!-- subjects injected here -->
          </div>

          <div class="summary-row" id="summaryRow">
            <div class="summary-cell"><div class="lbl">Total Marks</div><div class="val" id="sum-total">—</div></div>
            <div class="summary-cell"><div class="lbl">Obtained</div><div class="val" id="sum-obtained">—</div></div>
            <div class="summary-cell"><div class="lbl">Percentage</div><div class="val" id="sum-pct" style="color:var(--blue)">—</div></div>
            <div class="summary-cell"><div class="lbl">Grade / Result</div><div class="val" id="sum-grade">—</div></div>
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;padding-top:18px;border-top:1px solid var(--border);margin-top:18px">
            <button class="btn btn-primary" onclick="saveManual()"><i class="fas fa-save"></i> Save Result</button>
            <button class="btn btn-outline" onclick="saveAndNext()"><i class="fas fa-forward"></i> Save & Add Next</button>
            <button class="btn btn-ghost"   onclick="clearManual()"><i class="fas fa-undo"></i> Clear Form</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ══════════════ VIEW ALL ══════════════ -->
    <div class="panel" id="panel-view">
      <div class="card">
        <div class="card-hd">
          <div class="card-hd-l">
            <div class="card-ico ci-blue"><i class="fas fa-table"></i></div>
            <div><div class="card-title">All Student Results</div><div class="card-sub" id="viewCount">0 records</div></div>
          </div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn btn-outline btn-sm" onclick="exportExcel()"><i class="fas fa-file-excel" style="color:#16a34a"></i> Export Excel</button>
            <button class="btn btn-outline btn-sm" onclick="exportCSV()"><i class="fas fa-file-csv" style="color:var(--blue)"></i> Export CSV</button>
            <button class="btn btn-primary btn-sm" onclick="printAllResults()"><i class="fas fa-print"></i> Print All Results</button>
          </div>
        </div>
        <div class="card-body" style="padding-bottom:0">
          <div class="filter-bar">
            <div class="search-wrap">
              <i class="fas fa-search"></i>
              <input class="search-field" id="srchQ" placeholder="Search by name, roll, department…" oninput="applyFilter()">
            </div>
            <select class="filter-sel" id="fSem"    onchange="applyFilter()">
              <option value="">All Semesters</option>
              <option>1st Sem</option><option>2nd Sem</option><option>3rd Sem</option>
              <option>4th Sem</option><option>5th Sem</option><option>6th Sem</option>
              <option>7th Sem</option><option>8th Sem</option>
            </select>
            <select class="filter-sel" id="fStatus" onchange="applyFilter()">
              <option value="">All Status</option>
              <option>Pass</option><option>Fail</option>
            </select>
            <select class="filter-sel" id="fGrade"  onchange="applyFilter()">
              <option value="">All Grades</option>
              <option>A</option><option>B</option><option>C</option><option>D</option><option>F</option>
            </select>
            <button class="btn btn-ghost btn-sm" onclick="resetFilter()"><i class="fas fa-times"></i> Clear</button>
          </div>
        </div>
        <div class="tbl-wrap">
          <table class="data-tbl">
            <thead>
              <tr>
                <th><input type="checkbox" id="chkAll" onclick="toggleAll(this)" style="cursor:pointer;accent-color:var(--blue)"></th>
                <th>#</th><th>Name</th><th>Roll No.</th><th>Symbol No.</th><th>Department</th>
                <th>Semester</th><th>Total</th><th>Obtained</th>
                <th>%</th><th>Grade</th><th>Status</th><th>Actions</th>
              </tr>
            </thead>
            <tbody id="viewTbody">
              <tr><td colspan="12"><div class="empty"><div class="empty-icon"><i class="fas fa-inbox"></i></div><h3>No results yet</h3><p>Upload an Excel file or enter results manually to get started.</p></div></td></tr>
            </tbody>
          </table>
        </div>
        <div class="pagination">
          <div class="pg-info" id="viewPgInfo"></div>
          <div class="pg-btns" id="viewPgBtns"></div>
        </div>
      </div>
    </div>

    <!-- ══════════════ MARKSHEET ══════════════ -->
    <div class="panel" id="panel-marksheet">

      <div class="card no-print" style="margin-bottom:18px">
        <div class="card-hd">
          <div class="card-hd-l">
            <div class="card-ico ci-blue"><i class="fas fa-search"></i></div>
            <div><div class="card-title">Find Student Marksheet</div><div class="card-sub">Search by name or roll number</div></div>
          </div>
        </div>
        <div class="card-body">
          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:14px">
            <div class="search-wrap" style="max-width:340px">
              <i class="fas fa-search"></i>
              <input class="search-field" id="msQ" placeholder="Name or roll number…" oninput="msSearch()">
            </div>
            <select class="filter-sel" id="msSem" onchange="msSearch()">
              <option value="">All Semesters</option>
              <option>1st Sem</option><option>2nd Sem</option><option>3rd Sem</option>
              <option>4th Sem</option><option>5th Sem</option><option>6th Sem</option>
            </select>
          </div>
          <div id="msResults" style="display:flex;flex-wrap:wrap;gap:10px"></div>
        </div>
      </div>

      <div id="msOutput" style="display:none">
        <div class="ms-wrap" id="msPrintArea">
          <div class="ms-hd">
            <div class="ms-college-name">College of Excellence</div>
            <div class="ms-college-sub">Affiliated to State University · Established 1987 · NAAC Accredited</div>
            <div class="ms-type-badge" id="ms-exam-label">Official Grade Report</div>
          </div>
          <div class="ms-info-grid">
            <div class="ms-info-cell"><div class="ms-info-lbl">Student Name</div><div class="ms-info-val" id="ms-name">—</div></div>
            <div class="ms-info-cell"><div class="ms-info-lbl">Roll Number</div><div class="ms-info-val" id="ms-roll">—</div></div>
            <div class="ms-info-cell"><div class="ms-info-lbl">Symbol Number</div><div class="ms-info-val" id="ms-symbol">—</div></div>
            <div class="ms-info-cell"><div class="ms-info-lbl">Department</div><div class="ms-info-val" id="ms-dept">—</div></div>
            <div class="ms-info-cell"><div class="ms-info-lbl">Semester</div><div class="ms-info-val" id="ms-sem">—</div></div>
            <div class="ms-info-cell"><div class="ms-info-lbl">Academic Year</div><div class="ms-info-val" id="ms-year">2023–24</div></div>
            <div class="ms-info-cell"><div class="ms-info-lbl">Exam Type</div><div class="ms-info-val" id="ms-type">—</div></div>
          </div>
          <div class="ms-body">
            <table class="ms-tbl">
              <thead><tr><th>Subject</th><th>Max Marks</th><th>Obtained</th><th>Percentage</th><th>Grade</th><th>Remarks</th></tr></thead>
              <tbody id="ms-tbody"></tbody>
            </table>
            <div class="ms-totals">
              <div><div class="ms-tot-lbl">Total Marks</div><div class="ms-tot-val" id="ms-total">—</div></div>
              <div><div class="ms-tot-lbl">Marks Obtained</div><div class="ms-tot-val" id="ms-obtained">—</div></div>
              <div><div class="ms-tot-lbl">Percentage</div><div class="ms-tot-val" id="ms-pct">—</div></div>
              <div><div class="ms-tot-lbl">Final Result</div><div class="ms-tot-val" id="ms-result">—</div></div>
            </div>
          </div>
          <div class="ms-footer">
            <span>Generated: <strong id="ms-date"></strong></span>
            <span>Controller of Examinations</span>
            <span style="font-style:italic;opacity:.6">This is a computer-generated document.</span>
          </div>
        </div>
        <div style="display:flex;gap:10px;margin-top:16px;flex-wrap:wrap" class="no-print">
          <button class="btn btn-primary" onclick="printMs()"><i class="fas fa-print"></i> Print / Save PDF</button>
          <button class="btn btn-outline" onclick="closeMs()"><i class="fas fa-times"></i> Close</button>
        </div>
      </div>
    </div>

  </div><!-- /content -->
</div><!-- /main -->

<script>
// ═══════════════════ STATE ═══════════════════
let DB = [];           // master results array
let preview = [];      // upload preview
let filtered = [];     // view tab filtered

let viewPage   = 1; const perPage = 12;
let prevPage   = 1; const prevPerPage = 10;

// ═══════════════════ SIDEBAR ═══════════════════
function toggleSb() {
  document.getElementById('sidebar').classList.toggle('open');
  document.getElementById('sbOverlay').classList.toggle('active');
}
function closeSb() {
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('sbOverlay').classList.remove('active');
}
function setNav(el) {
  document.querySelectorAll('.sb-link').forEach(l => l.classList.remove('active'));
  el.classList.add('active');
  if (window.innerWidth <= 768) closeSb();
}

// ═══════════════════ TABS ═══════════════════
const tabs = ['dash','upload','manual','view','marksheet'];
const crumbs = { dash:'Dashboard', upload:'Upload Results', manual:'Manual Entry', view:'View All Results', marksheet:'Marksheets' };

function switchTab(id) {
  tabs.forEach(t => {
    document.getElementById('tab-'+t).classList.toggle('active', t===id);
    document.getElementById('panel-'+t).classList.toggle('active', t===id);
  });
  document.getElementById('tbCrumb').textContent = crumbs[id] || id;
  if (id === 'view') renderView();
  if (id === 'dash') refreshDash();
}

// ═══════════════════ TOAST ═══════════════════
function toast(msg, type='ok') {
  const icons = { ok:'fa-circle-check', err:'fa-circle-exclamation', info:'fa-circle-info' };
  const t = document.createElement('div');
  t.className = `toast ${type}`;
  t.innerHTML = `<i class="fas ${icons[type]}"></i>${msg}`;
  document.getElementById('toastStack').appendChild(t);
  setTimeout(() => t.remove(), 3400);
}

// ═══════════════════ HELPERS ═══════════════════
const pct  = (obt, tot)  => tot ? Math.round(obt / tot * 100) : 0;
const grade = p => p>=90?'A': p>=75?'B': p>=55?'C': p>=40?'D':'F';
const gradeClass = g => `g-${g}`;
const status = p => p >= 40 ? 'Pass' : 'Fail';

// ═══════════════════ UPLOAD ═══════════════════
const uzone = document.getElementById('uploadZone');
uzone.addEventListener('dragover', e => { e.preventDefault(); uzone.classList.add('over'); });
uzone.addEventListener('dragleave', () => uzone.classList.remove('over'));
uzone.addEventListener('drop', e => { e.preventDefault(); uzone.classList.remove('over'); if (e.dataTransfer.files[0]) processFile(e.dataTransfer.files[0]); });

function handleFile(e) { if (e.target.files[0]) processFile(e.target.files[0]); }

function processFile(file) {
  const ext = file.name.split('.').pop().toLowerCase();
  if (!['xlsx','xls','csv'].includes(ext)) { toast('Unsupported format. Use .xlsx, .xls or .csv', 'err'); return; }

  const pw = document.getElementById('progWrap');
  const fill = document.getElementById('progFill');
  const ppct = document.getElementById('progPct');
  const plbl = document.getElementById('progLbl');
  pw.classList.add('show'); let v = 0;

  const iv = setInterval(() => {
    v += Math.random() * 18; if (v > 88) { clearInterval(iv); v = 88; }
    fill.style.width = v+'%'; ppct.textContent = Math.round(v)+'%';
  }, 110);

  const r = new FileReader();
  r.onload = ev => {
    clearInterval(iv); fill.style.width = '100%'; ppct.textContent = '100%'; plbl.textContent = 'Done!';
    try {
      const wb = XLSX.read(ev.target.result, { type:'binary' });
      const ws = wb.Sheets[wb.SheetNames[0]];
      const raw = XLSX.utils.sheet_to_json(ws, { defval:'' });

      preview = raw.map(row => {
        const name    = row.name    || row.Name    || row.NAME    || '';
        const roll    = String(row.roll || row.Roll || row['Roll No'] || row.roll_no || '');
        const symbol  = String(row.symbol || row.Symbol || row['Symbol No'] || row.symbol_no || row['Symbol Number'] || '');
        const dept    = row.department || row.Department || row.dept || '';
        const sem     = row.semester   || row.Semester   || row.sem  || '';
        const total   = parseFloat(row.total   || row.Total   || row.max_marks || 0);
        const obtained= parseFloat(row.obtained|| row.Obtained|| row.marks     || 0);
        const p       = pct(obtained, total);
        const g       = grade(p);
        const st      = row.status || row.Status || status(p);
        return { name, roll, symbol, dept, sem, total, obtained, pct:p, grade:g, status:st, year:'', examType:'Final Examination', subjects:[] };
      }).filter(r => r.name && r.roll);

      setTimeout(() => {
        pw.classList.remove('show'); fill.style.width='0%';
        plbl.textContent = 'Reading file…';
        showPreview();
        toast(`${preview.length} records loaded — review before importing.`, 'info');
      }, 600);
    } catch(err) {
      pw.classList.remove('show');
      toast('Could not read file. Check the format and try again.', 'err');
    }
  };
  r.readAsBinaryString(file);
}

function showPreview() {
  document.getElementById('previewCard').style.display = 'block';
  document.getElementById('prevSubtitle').textContent = `${preview.length} records ready to import`;
  prevPage = 1; renderPreview();
}

function renderPreview() {
  const start = (prevPage-1)*prevPerPage;
  const slice = preview.slice(start, start+prevPerPage);
  document.getElementById('prevTbody').innerHTML = slice.map((r,i) => `
    <tr>
      <td style="color:var(--text-muted)">${start+i+1}</td>
      <td><strong>${r.name}</strong></td>
      <td style="color:var(--text-muted);font-size:.78rem">${r.roll}</td>
      <td>${r.dept||'—'}</td>
      <td>${r.sem||'—'}</td>
      <td>${r.total}</td>
      <td>${r.obtained}</td>
      <td><strong>${r.pct}%</strong></td>
      <td><span class="grade-chip ${gradeClass(r.grade)}">${r.grade}</span></td>
      <td><span class="status-pill ${r.status==='Pass'?'sp-pass':'sp-fail'}">${r.status}</span></td>
    </tr>`).join('');

  const tot = preview.length; const pages = Math.ceil(tot/prevPerPage);
  document.getElementById('prevPgInfo').textContent = `Showing ${start+1}–${Math.min(start+prevPerPage,tot)} of ${tot}`;
  const btns = document.getElementById('prevPgBtns'); btns.innerHTML='';
  for (let p=1;p<=pages;p++) {
    const b=document.createElement('button'); b.className='pg-btn'+(p===prevPage?' active':'');
    b.textContent=p; b.onclick=()=>{prevPage=p;renderPreview();}; btns.appendChild(b);
  }
}

function confirmImport() {
  if (!preview.length) return;
  DB = [...DB, ...preview];
  updateTabCount();
  clearUpload(); refreshDash();
  toast(`${preview.length} results imported successfully!`, 'ok');
  switchTab('view');
}

function clearUpload() {
  preview=[];
  document.getElementById('previewCard').style.display='none';
  document.getElementById('fileIn').value='';
}

function dlTemplate() {
  const ws = XLSX.utils.aoa_to_sheet([
    ['name','roll','symbol','department','semester','total','obtained'],
    ['Priya Sharma','2022CS001','11201001','Computer Science','3rd Sem',600,528],
    ['Rahul Verma','2022CS002','11201002','Computer Science','3rd Sem',600,462],
    ['Anika Patel','2022EL001','11202001','Electronics','3rd Sem',600,315],
  ]);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Results');
  XLSX.writeFile(wb, 'results_template.xlsx');
  toast('Template downloaded!', 'info');
}

// ═══════════════════ MANUAL ENTRY ═══════════════════
let subjCount = 0;

function initSubjects() {
  document.getElementById('subjGrid').innerHTML = '';
  subjCount = 0;
  ['Mathematics','Physics','Chemistry'].forEach(n => addSubj(n));
}

function addSubj(defaultName='') {
  subjCount++;
  const div = document.createElement('div');
  div.className = 'subj-card';
  div.innerHTML = `
    <div class="subj-label">
      Subject ${subjCount}
      <button onclick="removeSubj(this)" style="background:none;border:none;cursor:pointer;color:var(--rose);font-size:.8rem" title="Remove"><i class="fas fa-times"></i></button>
    </div>
    <div class="mini-lbl">Subject Name</div>
    <input class="mini-ctrl" placeholder="e.g. Mathematics" value="${defaultName}">
    <div class="mini-lbl">Max Marks</div>
    <input class="mini-ctrl" type="number" placeholder="100" oninput="calcSummary()">
    <div class="mini-lbl">Marks Obtained</div>
    <input class="mini-ctrl" type="number" placeholder="80" oninput="calcSummary()">`;
  document.getElementById('subjGrid').appendChild(div);
}

function removeSubj(btn) {
  const cards = document.querySelectorAll('.subj-card');
  if (cards.length <= 1) { toast('At least one subject is required.', 'err'); return; }
  btn.closest('.subj-card').remove();
  calcSummary();
}

function calcSummary() {
  let totMax=0, totObt=0;
  document.querySelectorAll('.subj-card').forEach(c => {
    const ins = c.querySelectorAll('input[type="number"]');
    totMax += parseFloat(ins[0].value)||0;
    totObt += parseFloat(ins[1].value)||0;
  });
  document.getElementById('sum-total').textContent   = totMax||'—';
  document.getElementById('sum-obtained').textContent= totObt||'—';
  if (totMax > 0) {
    const p = pct(totObt,totMax); const g = grade(p); const s = status(p);
    document.getElementById('sum-pct').textContent = p+'%';
    document.getElementById('sum-grade').innerHTML  = `<span class="grade-chip ${gradeClass(g)}">${g}</span>&nbsp;<span class="status-pill ${s==='Pass'?'sp-pass':'sp-fail'}">${s}</span>`;
  } else {
    document.getElementById('sum-pct').textContent  = '—';
    document.getElementById('sum-grade').textContent= '—';
  }
}

function buildManualObj() {
  const name = document.getElementById('m-name').value.trim();
  const roll = document.getElementById('m-roll').value.trim();
  const symbol = document.getElementById('m-symbol').value.trim();
  const dept = document.getElementById('m-dept').value;
  const sem  = document.getElementById('m-sem').value;
  const year = document.getElementById('m-year').value;
  const examType = document.getElementById('m-examtype').value;
  if (!name||!roll||!sem) { toast('Name, Roll Number and Semester are required.','err'); return null; }
  if (!symbol) { toast('Symbol Number is required.','err'); return null; }

  let totMax=0, totObt=0;
  const subjects = [];
  document.querySelectorAll('.subj-card').forEach(c => {
    const ins = c.querySelectorAll('input');
    const sn  = ins[0].value.trim()||'Subject';
    const mx  = parseFloat(ins[1].value)||0;
    const ob  = parseFloat(ins[2].value)||0;
    totMax += mx; totObt += ob;
    subjects.push({ name:sn, max:mx, obt:ob });
  });
  if (!totMax) { toast('Enter marks for at least one subject.','err'); return null; }

  const p = pct(totObt,totMax);
  return { name, roll, symbol, dept, sem, year, examType, total:totMax, obtained:totObt, pct:p, grade:grade(p), status:status(p), subjects };
}

function saveManual() {
  const obj = buildManualObj(); if (!obj) return;
  DB.push(obj); updateTabCount(); refreshDash();
  toast(`Result for ${obj.name} saved!`, 'ok');
  clearManual();
}

function saveAndNext() {
  const obj = buildManualObj(); if (!obj) return;
  DB.push(obj); updateTabCount(); refreshDash();
  toast(`Saved! Enter the next record.`, 'ok');
  clearManual();
}

function clearManual() {
  ['m-name','m-roll','m-symbol','m-year'].forEach(id => document.getElementById(id).value='');
  document.getElementById('m-dept').value='';
  document.getElementById('m-sem').value='';
  initSubjects(); calcSummary();
}

// ═══════════════════ VIEW ALL ═══════════════════
function applyFilter() {
  const q = document.getElementById('srchQ').value.toLowerCase();
  const sem = document.getElementById('fSem').value;
  const st  = document.getElementById('fStatus').value;
  const g   = document.getElementById('fGrade').value;
  filtered = DB.filter(r =>
    (!q   || r.name.toLowerCase().includes(q) || r.roll.toLowerCase().includes(q) || (r.dept||'').toLowerCase().includes(q)) &&
    (!sem || r.sem === sem) &&
    (!st  || r.status === st) &&
    (!g   || r.grade === g)
  );
  viewPage = 1; renderView();
}

function resetFilter() {
  ['srchQ'].forEach(id=>document.getElementById(id).value='');
  ['fSem','fStatus','fGrade'].forEach(id=>document.getElementById(id).value='');
  applyFilter();
}

function renderView() {
  filtered = (filtered.length===0 && !document.getElementById('srchQ').value) ? [...DB] : filtered;
  document.getElementById('viewCount').textContent = `${filtered.length} records`;

  const start = (viewPage-1)*perPage;
  const slice = filtered.slice(start, start+perPage);
  const tbody = document.getElementById('viewTbody');

  if (!DB.length) {
    tbody.innerHTML = `<tr><td colspan="12"><div class="empty"><div class="empty-icon"><i class="fas fa-inbox"></i></div><h3>No results yet</h3><p>Upload a spreadsheet or add entries manually to get started.</p></div></td></tr>`;
    document.getElementById('viewPgInfo').textContent=''; document.getElementById('viewPgBtns').innerHTML=''; return;
  }

  tbody.innerHTML = slice.map((r,i) => `
    <tr>
      <td><input type="checkbox" class="row-chk" style="accent-color:var(--blue);cursor:pointer"></td>
      <td style="color:var(--text-muted)">${start+i+1}</td>
      <td><strong>${r.name}</strong></td>
      <td style="font-size:.78rem;color:var(--text-muted)">${r.roll}</td>
      <td style="font-size:.78rem;font-weight:600;color:var(--blue)">${r.symbol||'—'}</td>
      <td>${r.dept||'—'}</td>
      <td>${r.sem||'—'}</td>
      <td>${r.total}</td>
      <td>${r.obtained}</td>
      <td><strong>${r.pct}%</strong></td>
      <td><span class="grade-chip ${gradeClass(r.grade)}">${r.grade}</span></td>
      <td><span class="status-pill ${r.status==='Pass'?'sp-pass':'sp-fail'}">${r.status}</span></td>
      <td style="white-space:nowrap">
        <button class="act edit" onclick="openEdit(${DB.indexOf(r)})" title="Edit"><i class="fas fa-pen"></i></button>
        <button class="act view" onclick="quickMs(${DB.indexOf(r)})" title="Marksheet"><i class="fas fa-file-invoice"></i></button>
        <button class="act del"  onclick="delResult(${DB.indexOf(r)})" title="Delete"><i class="fas fa-trash"></i></button>
      </td>
    </tr>`).join('');

  const tot = filtered.length; const pages = Math.ceil(tot/perPage);
  document.getElementById('viewPgInfo').textContent = `Showing ${start+1}–${Math.min(start+perPage,tot)} of ${tot}`;
  const btns = document.getElementById('viewPgBtns'); btns.innerHTML='';
  for (let p=Math.max(1,viewPage-2); p<=Math.min(pages,viewPage+2); p++) {
    const b=document.createElement('button'); b.className='pg-btn'+(p===viewPage?' active':'');
    b.textContent=p; b.onclick=()=>{viewPage=p;renderView();}; btns.appendChild(b);
  }
}

function toggleAll(cb) { document.querySelectorAll('.row-chk').forEach(c=>c.checked=cb.checked); }

function delResult(idx) {
  if (!confirm('Delete this result? This cannot be undone.')) return;
  DB.splice(idx,1); filtered=[...DB]; updateTabCount(); refreshDash(); renderView();
  toast('Result deleted.', 'info');
}

// ═══════════════════ EDIT MODAL ═══════════════════
let editIdx = -1;
function openEdit(idx) {
  editIdx = idx; const r = DB[idx];
  document.getElementById('e-name').value    = r.name;
  document.getElementById('e-roll').value    = r.roll;
  document.getElementById('e-symbol').value  = r.symbol||'';
  document.getElementById('e-dept').value    = r.dept||'';
  document.getElementById('e-sem').value     = r.sem||'1st Sem';
  document.getElementById('e-total').value   = r.total;
  document.getElementById('e-obtained').value= r.obtained;
  document.getElementById('editModal').classList.add('open');
}
function closeModal() { document.getElementById('editModal').classList.remove('open'); editIdx=-1; }
function saveEdit() {
  if (editIdx<0) return;
  const r = DB[editIdx];
  r.name     = document.getElementById('e-name').value;
  r.roll     = document.getElementById('e-roll').value;
  r.symbol   = document.getElementById('e-symbol').value;
  r.dept     = document.getElementById('e-dept').value;
  r.sem      = document.getElementById('e-sem').value;
  r.total    = parseFloat(document.getElementById('e-total').value)||r.total;
  r.obtained = parseFloat(document.getElementById('e-obtained').value)||r.obtained;
  r.pct      = pct(r.obtained,r.total);
  r.grade    = grade(r.pct);
  r.status   = status(r.pct);
  closeModal(); filtered=[...DB]; renderView(); refreshDash();
  toast('Result updated!', 'ok');
}
document.getElementById('editModal').addEventListener('click', e=>{ if(e.target===document.getElementById('editModal')) closeModal(); });

// ═══════════════════ MARKSHEET ═══════════════════
function msSearch() {
  const q = document.getElementById('msQ').value.toLowerCase();
  const sem = document.getElementById('msSem').value;
  const results = DB.filter(r =>
    (!q || r.name.toLowerCase().includes(q) || r.roll.toLowerCase().includes(q)) &&
    (!sem || r.sem===sem)
  ).slice(0,9);

  const container = document.getElementById('msResults');
  if (!results.length) { container.innerHTML = q ? `<span style="font-size:.8rem;color:var(--text-muted)">No matching student found.</span>` : ''; return; }
  container.innerHTML = results.map(r => `
    <button class="ms-search-chip" onclick="loadMs(${DB.indexOf(r)})">
      <div class="ms-search-chip-name">${r.name}</div>
      <div class="ms-search-chip-meta">${r.roll} · ${r.sem||'—'} · <span class="status-pill ${r.status==='Pass'?'sp-pass':'sp-fail'}" style="font-size:.62rem;padding:2px 6px">${r.status}</span> <strong style="color:var(--blue)">${r.pct}%</strong></div>
    </button>`).join('');
}

function loadMs(idx) {
  const r = DB[idx];
  document.getElementById('ms-name').textContent  = r.name;
  document.getElementById('ms-roll').textContent  = r.roll;
  document.getElementById('ms-symbol').textContent= r.symbol||'N/A';
  document.getElementById('ms-dept').textContent  = r.dept||'N/A';
  document.getElementById('ms-sem').textContent   = r.sem||'N/A';
  document.getElementById('ms-year').textContent  = r.year||'2023–24';
  document.getElementById('ms-type').textContent  = r.examType||'Final Examination';
  document.getElementById('ms-exam-label').textContent = (r.examType||'Final Examination') + ' · Grade Report';
  document.getElementById('ms-date').textContent  = new Date().toLocaleDateString('en-IN', { day:'2-digit', month:'long', year:'numeric' });

  let rows = '';
  if (r.subjects && r.subjects.length) {
    r.subjects.forEach(s => {
      const sp = pct(s.obt,s.max); const sg = grade(sp);
      rows += `<tr>
        <td>${s.name}</td><td>${s.max}</td><td>${s.obt}</td>
        <td>${sp}%</td>
        <td><span class="grade-chip ${gradeClass(sg)}">${sg}</span></td>
        <td style="color:${sp>=40?'var(--emerald)':'var(--rose)'};font-weight:600">${sp>=40?'Pass':'Fail'}</td>
      </tr>`;
    });
  } else {
    rows = `<tr>
      <td>Combined / All Subjects</td><td>${r.total}</td><td>${r.obtained}</td>
      <td>${r.pct}%</td>
      <td><span class="grade-chip ${gradeClass(r.grade)}">${r.grade}</span></td>
      <td style="color:${r.status==='Pass'?'var(--emerald)':'var(--rose)'};font-weight:600">${r.status}</td>
    </tr>`;
  }
  document.getElementById('ms-tbody').innerHTML = rows;
  document.getElementById('ms-total').textContent   = r.total;
  document.getElementById('ms-obtained').textContent= r.obtained;
  document.getElementById('ms-pct').textContent     = r.pct+'%';
  document.getElementById('ms-result').textContent  = r.status;

  document.getElementById('msOutput').style.display='block';
  document.getElementById('msOutput').scrollIntoView({ behavior:'smooth', block:'start' });
}

function quickMs(idx) { switchTab('marksheet'); setTimeout(()=>loadMs(idx),80); }

function printMs() {
  const el = document.getElementById('msPrintArea');
  if (!el || document.getElementById('msOutput').style.display==='none') { toast('Open a marksheet first.','err'); return; }
  const w = window.open('','_blank');
  w.document.write(`<!DOCTYPE html><html><head><title>Marksheet</title>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif&family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Outfit',sans-serif;color:#0d1b2a;padding:28px}
    .ms-hd{background:#0d1b2a;color:#fff;padding:24px;text-align:center;border-radius:10px 10px 0 0}
    .ms-college-name{font-family:'Instrument Serif',serif;font-size:1.4rem}
    .ms-college-sub{font-size:.7rem;opacity:.5;margin-top:3px}
    .ms-type-badge{display:inline-block;margin-top:10px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.18);padding:3px 16px;border-radius:99px;font-size:.7rem;font-weight:600;letter-spacing:.8px;text-transform:uppercase}
    .ms-info-grid{display:grid;grid-template-columns:repeat(3,1fr);border-bottom:1px solid #e4e7ec}
    .ms-info-cell{padding:12px 18px;border-right:1px solid #e4e7ec}
    .ms-info-cell:last-child{border-right:none}
    .ms-info-lbl{font-size:.6rem;font-weight:600;text-transform:uppercase;letter-spacing:.8px;color:#64748b;margin-bottom:3px}
    .ms-info-val{font-size:.85rem;font-weight:600}
    .ms-body{padding:20px 24px}
    table{width:100%;border-collapse:collapse;margin-bottom:18px}
    thead tr{background:#f4f5f7}
    th{padding:9px 12px;font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:#64748b;text-align:left;border-bottom:2px solid #e4e7ec}
    td{padding:9px 12px;font-size:.82rem;border-bottom:1px solid #e4e7ec}
    .ms-totals{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;background:#0d1b2a;border-radius:8px;padding:14px 18px;color:#fff}
    .ms-tot-lbl{font-size:.6rem;opacity:.55;text-transform:uppercase;letter-spacing:.6px;margin-bottom:3px}
    .ms-tot-val{font-family:'Instrument Serif',serif;font-size:1.25rem}
    .ms-footer{padding:12px 18px;border-top:1px solid #e4e7ec;display:flex;justify-content:space-between;font-size:.7rem;color:#64748b;flex-wrap:wrap;gap:6px}
    @media print{body{padding:0}}
    </style></head><body>`);
  w.document.write(el.outerHTML);
  w.document.write('</body></html>');
  w.document.close();
  setTimeout(()=>w.print(), 700);
}

function closeMs() { document.getElementById('msOutput').style.display='none'; }

// ═══════════════════ PRINT ALL RESULTS ═══════════════════
function printAllResults() {
  if (!DB.length) { toast('No results to print.','err'); return; }
  const src = filtered.length ? filtered : DB;
  const pass  = src.filter(r=>r.status==='Pass').length;
  const fail  = src.length - pass;
  const avg   = src.length ? Math.round(src.reduce((a,r)=>a+r.pct,0)/src.length) : 0;
  const today = new Date().toLocaleDateString('en-IN',{day:'2-digit',month:'long',year:'numeric'});

  const rows = src.map((r,i)=>`
    <tr>
      <td>${i+1}</td>
      <td><strong>${r.name}</strong></td>
      <td>${r.roll}</td>
      <td style="font-weight:700;color:#1a56db">${r.symbol||'—'}</td>
      <td>${r.dept||'—'}</td>
      <td>${r.sem||'—'}</td>
      <td>${r.total}</td>
      <td>${r.obtained}</td>
      <td><strong>${r.pct}%</strong></td>
      <td><span style="display:inline-flex;align-items:center;justify-content:center;width:26px;height:26px;border-radius:6px;font-size:.72rem;font-weight:700;background:${r.grade==='A'?'#d1fae5':r.grade==='B'?'#d1fae5':r.grade==='C'?'#fef3c7':r.grade==='D'?'#fed7aa':'#fee2e2'};color:${r.grade==='A'?'#059669':r.grade==='B'?'#065f46':r.grade==='C'?'#d97706':r.grade==='D'?'#c2410c':'#dc2626'}">${r.grade}</span></td>
      <td><span style="padding:2px 10px;border-radius:99px;font-size:.68rem;font-weight:600;background:${r.status==='Pass'?'#d1fae5':'#fee2e2'};color:${r.status==='Pass'?'#059669':'#dc2626'}">${r.status}</span></td>
    </tr>`).join('');

  const w = window.open('','_blank');
  w.document.write(`<!DOCTYPE html><html><head><title>All Results — College of Excellence</title>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Outfit',sans-serif;color:#0d1b2a;padding:28px 32px;background:#fff}
    .hd{background:#0d1b2a;color:#fff;padding:22px 28px;border-radius:10px 10px 0 0;display:flex;align-items:center;justify-content:space-between}
    .hd-l{}
    .college{font-family:'Instrument Serif',serif;font-size:1.4rem}
    .college-sub{font-size:.7rem;opacity:.5;margin-top:2px}
    .hd-r{text-align:right;font-size:.72rem;opacity:.6}
    .meta{display:flex;gap:0;background:#f4f5f7;border:1px solid #e4e7ec;border-top:none;border-radius:0}
    .meta-cell{padding:10px 18px;border-right:1px solid #e4e7ec;flex:1;text-align:center}
    .meta-cell:last-child{border-right:none}
    .meta-lbl{font-size:.6rem;font-weight:600;text-transform:uppercase;letter-spacing:.8px;color:#64748b;margin-bottom:2px}
    .meta-val{font-family:'Instrument Serif',serif;font-size:1.2rem;color:#0d1b2a}
    table{width:100%;border-collapse:collapse;margin-top:16px;font-size:.8rem}
    thead tr{background:#0d1b2a;color:#fff}
    th{padding:10px 12px;font-size:.65rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;text-align:left;white-space:nowrap}
    tbody tr{border-bottom:1px solid #e4e7ec}
    tbody tr:nth-child(even){background:#f8fafc}
    tbody tr:hover{background:#f0f4ff}
    td{padding:9px 12px;vertical-align:middle}
    .footer{margin-top:28px;padding-top:14px;border-top:1px solid #e4e7ec;display:flex;justify-content:space-between;font-size:.7rem;color:#64748b;flex-wrap:wrap;gap:8px}
    .sig-area{margin-top:40px;display:flex;justify-content:space-between;padding:0 20px}
    .sig-line{border-top:1px solid #0d1b2a;padding-top:6px;font-size:.72rem;color:#64748b;text-align:center;min-width:150px}
    @media print{body{padding:12px}@page{margin:14mm}}
  </style></head><body>
  <div class="hd">
    <div class="hd-l">
      <div class="college">College of Excellence</div>
      <div class="college-sub">Affiliated to State University · NAAC Accredited</div>
    </div>
    <div class="hd-r">
      <div style="font-size:.85rem;font-weight:600">Complete Result Sheet</div>
      <div>Generated: ${today}</div>
      <div>Total Records: ${src.length}</div>
    </div>
  </div>
  <div class="meta">
    <div class="meta-cell"><div class="meta-lbl">Total Students</div><div class="meta-val">${src.length}</div></div>
    <div class="meta-cell"><div class="meta-lbl">Passed</div><div class="meta-val" style="color:#059669">${pass}</div></div>
    <div class="meta-cell"><div class="meta-lbl">Failed</div><div class="meta-val" style="color:#dc2626">${fail}</div></div>
    <div class="meta-cell"><div class="meta-lbl">Pass Rate</div><div class="meta-val" style="color:#1a56db">${src.length?Math.round(pass/src.length*100):0}%</div></div>
    <div class="meta-cell"><div class="meta-lbl">Class Average</div><div class="meta-val">${avg}%</div></div>
  </div>
  <table>
    <thead><tr><th>#</th><th>Student Name</th><th>Roll No.</th><th>Symbol No.</th><th>Department</th><th>Semester</th><th>Total</th><th>Obtained</th><th>%</th><th>Grade</th><th>Status</th></tr></thead>
    <tbody>${rows}</tbody>
  </table>
  <div class="sig-area">
    <div class="sig-line">Class Teacher</div>
    <div class="sig-line">Head of Department</div>
    <div class="sig-line">Controller of Examinations</div>
    <div class="sig-line">Principal</div>
  </div>
  <div class="footer">
    <span>College of Excellence · Result Management System</span>
    <span>Printed on: ${today}</span>
    <span style="font-style:italic;opacity:.6">This is a computer-generated document.</span>
  </div>
  </body></html>`);
  w.document.close();
  setTimeout(()=>w.print(), 700);
  toast(`Printing ${src.length} results…`, 'info');
}

// ═══════════════════ EXPORT ═══════════════════
function exportExcel() {
  if (!DB.length) { toast('No results to export.','err'); return; }
  const data = DB.map((r,i) => ({ '#':i+1, 'Student Name':r.name, 'Roll No':r.roll, 'Symbol No':r.symbol||'', 'Department':r.dept||'', 'Semester':r.sem||'', 'Total':r.total, 'Obtained':r.obtained, 'Percentage':r.pct+'%', 'Grade':r.grade, 'Status':r.status }));
  const ws = XLSX.utils.json_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Results');
  XLSX.writeFile(wb, 'college_results.xlsx');
  toast('Excel file exported!','ok');
}

function exportCSV() {
  if (!DB.length) { toast('No results to export.','err'); return; }
  const hdr = ['#','Student Name','Roll No','Symbol No','Department','Semester','Total','Obtained','Percentage','Grade','Status'];
  const rows = DB.map((r,i)=>[i+1,r.name,r.roll,r.symbol||'',r.dept||'',r.sem||'',r.total,r.obtained,r.pct+'%',r.grade,r.status]);
  const csv = [hdr,...rows].map(r=>r.map(c=>`"${c}"`).join(',')).join('\n');
  const a = document.createElement('a');
  a.href = URL.createObjectURL(new Blob([csv],{type:'text/csv'}));
  a.download = 'college_results.csv';
  a.click();
  toast('CSV file exported!','ok');
}

// ═══════════════════ DASHBOARD ═══════════════════
function refreshDash() {
  const tot   = DB.length;
  const pass  = DB.filter(r=>r.status==='Pass').length;
  const fail  = tot - pass;
  const avg   = tot ? Math.round(DB.reduce((a,r)=>a+r.pct,0)/tot) : 0;
  const pr    = tot ? Math.round(pass/tot*100) : 0;
  const fr    = tot ? Math.round(fail/tot*100) : 0;

  document.getElementById('s-total').textContent    = tot;
  document.getElementById('s-pass').textContent     = pass;
  document.getElementById('s-fail').textContent     = fail;
  document.getElementById('s-avg').textContent      = tot ? avg+'%' : '—';
  document.getElementById('s-pass-rate').textContent= pr+'%';
  document.getElementById('s-fail-rate').textContent= fr+'%';

  // Grade bars
  const grades = {A:0,B:0,C:0,D:0,F:0};
  DB.forEach(r => { if (grades[r.grade]!==undefined) grades[r.grade]++; });
  const colors = {A:'#059669',B:'#0d9488',C:'#d97706',D:'#ea580c',F:'#dc2626'};
  const gDiv = document.getElementById('gradeDistBody');
  if (!tot) {
    gDiv.innerHTML = '<div class="empty"><div class="empty-icon"><i class="fas fa-chart-bar"></i></div><h3>No data yet</h3><p>Upload or enter results to see grade distribution.</p></div>';
  } else {
    gDiv.innerHTML = Object.entries(grades).map(([g,cnt]) => {
      const p = Math.round(cnt/tot*100);
      return `<div class="grade-bar-row">
        <span class="grade-bar-lbl" style="color:${colors[g]}">${g}</span>
        <div class="grade-bar-track"><div class="grade-bar-fill" style="width:${p}%;background:${colors[g]}"></div></div>
        <span class="grade-bar-cnt">${cnt} student${cnt!==1?'s':''} (${p}%)</span>
      </div>`;
    }).join('');
  }

  // Top performers
  const topDiv = document.getElementById('topPerformBody');
  const top5 = [...DB].sort((a,b)=>b.pct-a.pct).slice(0,5);
  if (!top5.length) {
    topDiv.innerHTML = '<div class="empty"><div class="empty-icon"><i class="fas fa-trophy"></i></div><h3>No results yet</h3></div>';
  } else {
    topDiv.innerHTML = top5.map((r,i) => `
      <div class="top-student-row">
        <div class="rank-badge ${i===0?'rank-1':i===1?'rank-2':i===2?'rank-3':'rank-n'}">${i+1}</div>
        <div>
          <div class="top-sname">${r.name}</div>
          <div class="top-smeta">${r.roll} · ${r.sem||'—'}</div>
        </div>
        <span class="top-spct">${r.pct}%</span>
        <span class="grade-chip ${gradeClass(r.grade)}">${r.grade}</span>
      </div>`).join('');
  }

  // Recent
  const recent = DB.slice(-6).reverse();
  const rtb = document.getElementById('recentTbody');
  if (!recent.length) {
    rtb.innerHTML = `<tr><td colspan="8"><div class="empty"><div class="empty-icon"><i class="fas fa-inbox"></i></div><h3>No entries yet</h3></div></td></tr>`;
  } else {
    rtb.innerHTML = recent.map((r,i)=>`
      <tr>
        <td style="color:var(--text-muted)">${i+1}</td>
        <td><strong>${r.name}</strong></td>
        <td style="font-size:.78rem;color:var(--text-muted)">${r.roll}</td>
        <td>${r.sem||'—'}</td>
        <td>${r.obtained} / ${r.total}</td>
        <td><strong>${r.pct}%</strong></td>
        <td><span class="grade-chip ${gradeClass(r.grade)}">${r.grade}</span></td>
        <td><span class="status-pill ${r.status==='Pass'?'sp-pass':'sp-fail'}">${r.status}</span></td>
      </tr>`).join('');
  }
}

function updateTabCount() {
  document.getElementById('tc-view').textContent = DB.length;
}

// ═══════════════════ SEED DATA ═══════════════════
const seed = [
  {name:'Priya Sharma',roll:'2022CS001',symbol:'11201001',dept:'Computer Science',sem:'3rd Sem',year:'2023–24',examType:'Final Examination',total:600,obtained:558,pct:93,grade:'A',status:'Pass',subjects:[{name:'Data Structures',max:100,obt:96},{name:'DBMS',max:100,obt:94},{name:'OS',max:100,obt:92},{name:'Computer Networks',max:100,obt:90},{name:'Mathematics',max:100,obt:93},{name:'English',max:100,obt:93}]},
  {name:'Rohit Nair',roll:'2022CS002',symbol:'11201002',dept:'Computer Science',sem:'3rd Sem',year:'2023–24',examType:'Final Examination',total:600,obtained:474,pct:79,grade:'B',status:'Pass',subjects:[{name:'Data Structures',max:100,obt:80},{name:'DBMS',max:100,obt:75},{name:'OS',max:100,obt:82},{name:'Computer Networks',max:100,obt:76},{name:'Mathematics',max:100,obt:80},{name:'English',max:100,obt:81}]},
  {name:'Deepika Reddy',roll:'2022EL001',symbol:'11202001',dept:'Electronics',sem:'4th Sem',year:'2023–24',examType:'Final Examination',total:600,obtained:360,pct:60,grade:'C',status:'Pass',subjects:[{name:'Circuit Theory',max:100,obt:62},{name:'Signals & Systems',max:100,obt:58},{name:'Microprocessors',max:100,obt:60},{name:'EM Theory',max:100,obt:62},{name:'Digital Electronics',max:100,obt:58},{name:'Communication',max:100,obt:60}]},
  {name:'Arun Mehta',roll:'2022ME001',symbol:'11203001',dept:'Mechanical',sem:'2nd Sem',year:'2023–24',examType:'Mid-Term',total:600,obtained:216,pct:36,grade:'F',status:'Fail',subjects:[{name:'Engineering Mechanics',max:100,obt:38},{name:'Thermodynamics',max:100,obt:40},{name:'Fluid Mechanics',max:100,obt:30},{name:'Materials',max:100,obt:38},{name:'Manufacturing',max:100,obt:36},{name:'Drawing',max:100,obt:34}]},
  {name:'Sneha Patil',roll:'2022BA001',symbol:'11204001',dept:'Business Administration',sem:'1st Sem',year:'2023–24',examType:'Final Examination',total:600,obtained:510,pct:85,grade:'B',status:'Pass',subjects:[{name:'Accounting',max:100,obt:88},{name:'Economics',max:100,obt:84},{name:'Management',max:100,obt:90},{name:'Statistics',max:100,obt:82},{name:'Business Law',max:100,obt:80},{name:'HR Management',max:100,obt:86}]},
  {name:'Vikram Joshi',roll:'2022CS003',symbol:'11201003',dept:'Computer Science',sem:'3rd Sem',year:'2023–24',examType:'Final Examination',total:600,obtained:540,pct:90,grade:'A',status:'Pass',subjects:[{name:'Data Structures',max:100,obt:92},{name:'DBMS',max:100,obt:90},{name:'OS',max:100,obt:90},{name:'Computer Networks',max:100,obt:88},{name:'Mathematics',max:100,obt:90},{name:'English',max:100,obt:90}]},
];

DB = [...seed];
filtered = [...DB];
updateTabCount();
refreshDash();
initSubjects();
</script>

</body>
</html>